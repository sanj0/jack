tape=list<int>head_index=5001000for(idx=0;idxswapdupx1<;idx={idx++}){tape0push}dropwhile(true){code={readln@charlist}l={codelen}lfor(idx=0;idxswapdupx1<;idx={idx++}){c={codeidxget}cswitch{'+'=>{val={tapehead_indexget++}tapehead_indexvalset}'-'=>{val={tapehead_indexget--}tapehead_indexvalset}'<'=>head_index={head_index--}'>'=>head_index={head_index++}'.'=>{tapehead_indexgetprintc}','=>{input={readln@charlist0get}tapehead_indexinputset}'['=>if(tapehead_indexget0==){shift=1d=1while(d0>){idx={idxshift+}c={codeidxget}d=if(c'['==){dshift+}elseif(c']'==){dshift-}elsed}}']'=>if(tapehead_indexget){shift={0--}// forgot negative number literals lold=1while(d0>){idx={idxshift+}c={codeidxget}d=if(c'['==){dshift+}elseif(c']'==){dshift-}elsed}}default=>{}}}drop}// needs `shift` variable